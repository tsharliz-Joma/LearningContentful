'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var s = require('react');
var reactPopper = require('react-popper');
var emotion = require('emotion');
var i = require('@contentful/f36-tokens');
var f36Utils = require('@contentful/f36-utils');
var f36Core = require('@contentful/f36-core');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var s__default = /*#__PURE__*/_interopDefaultLegacy(s);
var i__default = /*#__PURE__*/_interopDefaultLegacy(i);

var se=Object.defineProperty;var d=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var A=(t,o,e)=>o in t?se(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,y=(t,o)=>{for(var e in o||(o={}))L.call(o,e)&&A(t,e,o[e]);if(d)for(var e of d(o))H.call(o,e)&&A(t,e,o[e]);return t};var K=(t,o)=>{var e={};for(var n in t)L.call(t,n)&&o.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&d)for(var n of d(t))o.indexOf(n)<0&&H.call(t,n)&&(e[n]=t[n]);return e};var V=(t,o,e)=>new Promise((n,u)=>{var b=a=>{try{p(e.next(a));}catch(l){u(l);}},h=a=>{try{p(e.throw(a));}catch(l){u(l);}},p=a=>a.done?n(a.value):Promise.resolve(a.value).then(b,h);p((e=e.apply(t,o)).next());});var v=`calc(-1 * ((1rem * (10 / ${i__default["default"].fontBaseDefault})) / 2))`,j=`calc(1rem * (10 / ${i__default["default"].fontBaseDefault}))`;function X(){return {tooltipTargetWrapper:emotion.css({display:"inline-block",position:"relative"}),tooltip:emotion.css({background:i__default["default"].gray900,fontFamily:i__default["default"].fontStackPrimary,fontSize:i__default["default"].fontSizeS,fontWeight:i__default["default"].fontWeightNormal,fontStyle:"normal",textDecoration:"none",color:i__default["default"].colorWhite,textAlign:"center",lineHeight:i__default["default"].lineHeightM,padding:`${i__default["default"].spacingXs} calc(1rem * (10 / ${i__default["default"].fontBaseDefault}))`,borderRadius:i__default["default"].borderRadiusMedium,whiteSpace:"normal",textTransform:"initial",letterSpacing:"initial"}),tooltipHidden:emotion.css({visibility:"hidden",pointerEvents:"none",zIndex:i__default["default"].zIndexNegative}),tooltipContainer:emotion.css({"& > button[disabled]":{pointerEvents:"none"}}),tooltipArrow:emotion.css({position:"absolute",'&[data-placement*="top"]':{bottom:0,left:0,marginBottom:v},'&[data-placement*="right"]':{left:0,marginLeft:v},'&[data-placement*="bottom"]':{left:0,top:0,marginTop:v},'&[data-placement*="left"]':{right:0,marginRight:v},"&::before":{content:'""',display:"block",height:j,width:j,backgroundColor:i__default["default"].gray900,transform:"rotate3d(0, 0, 1, 45deg)",zIndex:i__default["default"].zIndexNegative}})}}var me=ce=>{var N=ce,{children:t,className:o,as:e="span",content:n,id:u,isVisible:b=!1,hideDelay:h=0,onBlur:p,onFocus:a,onMouseLeave:l,onMouseOver:M,onKeyDown:C,showDelay:Q=0,targetWrapperClassName:R,maxWidth:x=360,testId:U="cf-ui-tooltip",placement:Y="auto",usePortal:Z=!1,isDisabled:_=!1}=N,ee=K(N,["children","className","as","content","id","isVisible","hideDelay","onBlur","onFocus","onMouseLeave","onMouseOver","onKeyDown","showDelay","targetWrapperClassName","maxWidth","testId","placement","usePortal","isDisabled"]);let S=X(),[te,f]=s.useState(b),z=f36Core.useId(u,"tooltip"),B=s.useRef(null),I=s.useRef(null),[oe,ne]=s.useState(null),{styles:k,attributes:T,update:E}=reactPopper.usePopper(B.current,I.current,{placement:Y,modifiers:[{name:"arrow",options:{element:oe,padding:parseFloat(i__default["default"].borderRadiusSmall)}},{name:"offset",options:{offset:[0,10]}}]});s.useEffect(()=>{(()=>V(void 0,null,function*(){E!==null&&(yield E());}))();},[n,E]);let D=s.useRef(),F=s.useRef(),m=()=>{clearTimeout(D.current),clearTimeout(F.current);};s.useEffect(()=>m,[]);let W=()=>{m(),D.current=setTimeout(()=>f(!0),Q);},P=()=>{m(),F.current=setTimeout(()=>f(!1),h);},re=typeof x=="string"?x:`${x}px`,ie=y({zIndex:i__default["default"].zIndexTooltip,maxWidth:re},k.popper);if(!n||_)return s__default["default"].createElement(f36Core.Box,{as:e,className:R},t);let $=s__default["default"].createElement(f36Core.Box,y({as:"span",id:z,ref:I,role:"tooltip",style:ie,className:emotion.cx(S.tooltip,o),testId:U,onMouseEnter:()=>{m(),f(!0);},onMouseLeave:()=>{m(),f(!1);}},T.popper),s__default["default"].createElement("span",null,n),s__default["default"].createElement("span",{className:S.tooltipArrow,"data-placement":T.popper&&T.popper["data-popper-placement"],ref:ne,style:k.arrow}));return s__default["default"].createElement(s__default["default"].Fragment,null,te?s__default["default"].createElement(s__default["default"].Fragment,null,Z?s__default["default"].createElement(f36Utils.Portal,null,$):$):null,s__default["default"].createElement(f36Core.Box,y({as:e,ref:B,className:emotion.cx(S.tooltipContainer,R),onMouseEnter:r=>{W(),M&&M(r);},onMouseLeave:r=>{P(),l&&l(r);},onFocus:r=>{W(),a&&a(r);},onBlur:r=>{P(),p&&p(r);},onKeyDown:r=>{r.key==="Escape"&&P(),C&&C(r);}},ee),s__default["default"].Children.map(t,r=>{if(s__default["default"].isValidElement(r))return s__default["default"].cloneElement(r,{"aria-describedby":z})})))};

exports.Tooltip = me;
//# sourceMappingURL=index.js.map